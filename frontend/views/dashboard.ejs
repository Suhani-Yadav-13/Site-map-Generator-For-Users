<% layout('layouts/main') %>

<div class="dashboard-bg py-4">
  <div class="container">
    <!-- Welcome Banner -->
    <div
      class="card shadow-sm md-8 mb-4 border-0 text-white rounded-4 welcome-card"
    >
      <div class="card-body text-center">
        <h3 class="fw-bold">ðŸ‘‹ Welcome back, <%= user.name %>!</h3>
        <p class="mb-0">
          Manage and generate sitemaps easily with <b>SitemapGen</b>.
        </p>
      </div>
    </div>

    <!-- Profile + Generate Row -->
    <div class="row">
      <!-- Profile -->
      <div class="col-md-4 mb-4">
        <div
          class="card shadow-sm text-center h-100 border-0 rounded-4 hover-card profile-card"
        >
          <div class="card-body d-flex flex-column align-items-center">
            <!-- Dynamic initial avatar -->
            <div
              class="rounded-circle d-flex justify-content-center align-items-center mb-3 shadow-sm"
              style="
                width: 90px;
                height: 90px;
                background-color: #0d6efd;
                color: white;
                font-size: 36px;
                font-weight: 600;
              "
            >
              <%= user.name.charAt(0).toUpperCase() %>
            </div>

            <h5 class="mb-1 fw-semibold"><%= user.name %></h5>
            <p class="text-muted mb-3"><%= user.email %></p>
            <a href="/profile" class="btn btn-gradient btn-sm fw-semibold">
              ðŸ‘¤ View Profile
            </a>
          </div>
        </div>
      </div>

      <!-- Generate Sitemap -->
      <div class="col-md-7 mt-3 mb-4">
        <div
          class="card shadow-sm border-0 text-white text-center h-100 rounded-4 hover-card generate-card"
        >
          <div class="card-body d-flex flex-column justify-content-center">
            <h5 class="mb-3 fw-bold">âš¡ Generate a New Sitemap</h5>
            <p>Quickly create and download sitemaps for your projects.</p>
            <a
              href="/generate"
              class="btn btn-light btn-lg fw-bold rounded-pill shadow-sm"
            >
              ðŸš€ Generate Now
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Sitemaps -->
    <div class="row">
      <div class="col-md-8 offset-md-2 mt-3">
        <div
          class="card shadow-sm border-0 mb-4 rounded-4 hover-card recent-card"
        >
          <div class="card-header text-white fw-bold text-center rounded-top-4">
            ðŸ“‚ Recent Sitemaps
          </div>
          <ul class="list-group list-group-flush">
            <% if (lastSitemaps.length > 0) { %> <%
            lastSitemaps.slice(0,3).forEach(smap => { %>
            <li
              class="list-group-item d-flex justify-content-between align-items-center list-hover"
            >
              <div>ðŸ—‚ <%= smap.projectName %></div>
              <small class="text-muted"
                ><%= smap.dateGenerated.toDateString() %></small
              >
            </li>
            <% }) %> <% } else { %>
            <li class="list-group-item text-muted text-center">
              No sitemaps generated yet.
            </li>
            <% } %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
